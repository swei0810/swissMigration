<!DOCTYPE html>
<html lang="en">

<head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <script src="https://d3js.org/d3.v5.min.js"></script>


        <script src='./src/citizenships.js' type='text/javascript'></script>
<script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>

        <link href="https://fonts.googleapis.com/css?family=Signika&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="stylesheet/graphs.css">


        <link href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">



        <title>Switzerland</title>
</head>

<body>
        <div class='home'>
                <h2>Switzerland Citizenship Data</h2>
        </div>

        <div class='all-graphs'>
                <div class="graph">
                        <div class='header'>Acquisition of Swiss citizenship</div>
                        <br />
                        <div class='buttons'>
                                <button onclick="update(data1, 'male')">Male</button>
                                <button onclick="update(data2, 'female')">Female</button>
                        </div>
                        <div class='citizenship'> </div>
                        <div>* Text goes here * </div>
                </div>
                <div class='mid'></div>
                <div class="graph">
                        <div class='header'>Naturalisation applications in 2014</div>
                        <br />
                        <button onclick="updatePie(data3, 'request')">Request</button>
                        <button onclick="updatePie(data4, 'intention')">Intention</button>
                        <button onclick="updatePie(data5, 'status')">Status</button>
                        
                        <div class='pie'></div>
                        <div class='legend'>
                                <div class='legend-1'>
                                        <div class='legend-title'>Request & Intention</div>

                                        <div class='legend-box'>
                                                <div class='box1'> </div>
                                                <div> Yes </div>
                                        </div>
                                        <div class='legend-box'>
                                                <div class='box2'> </div>
                                                <div> No </div>
                                        </div>
                                </div>
                                
                                <div class='legend-2'>

                                        <div class='legend-title'>Status</div>
                                        <div class='legend-box'>
                                                <div class='box1'> </div>
                                                <div>Refused by the authorities </div>
                                        </div>
                                        <div class='legend-box'>
                                                <div class='box2'> </div>
                                                <div>Withdrawn or suspended </div>
                                        </div>
                                        <div class='legend-box'>
                                                <div class='box3'> </div>
                                                <div>Still being processed </div>
                                        </div>
                                </div>


                        </div>
                        <div>* Text goes here * HAVE TO ADD TOOLTIPS </div>
<!-- After looking at your data, think of what other questions you might ask to understand your results better. Were you
surprised by them? Why? Did they lead you to wonder about other relationships or correlations? Make a note of your
questions.

Look for data to answer one of these follow up questions, and use Excel to generate a second chart illustrating your
results. Write another sentence or two explaining your results, and how they affect your initial understanding of the
data. -->


                </div>
        </div>


        <script>
                                var data1 = [
                                        { group: "2016", value: 20.4 },
                                        { group: "2017", value: 21.5 },
                                        { group: "2018", value: 20.2 }
                                ];

                                var data2 = [
                                        { group: "2016", value: 22.5 },
                                        { group: "2017", value: 23.4 },
                                        { group: "2018", value: 22.2 }
                                ];

                                // set the dimensions and margins of the graph
                                var margin = { top: 30, right: 30, bottom: 70, left: 60 },
                                        width = 460 - margin.left - margin.right,
                                        height = 400 - margin.top - margin.bottom;

                                // append the svg object to the body of the page
                                var svg = d3.select(".citizenship")
                                        .append("svg")
                                        .attr("width", width + margin.left + margin.right)
                                        .attr("height", height + margin.top + margin.bottom)
                                        .append("g")
                                        .attr("transform",
                                                "translate(" + margin.left + "," + margin.top + ")");

                                // X axis
                                var x = d3.scaleBand()
                                        .range([0, width])
                                        .domain(data1.map(function (d) { return d.group; }))
                                        .padding(0.2);
                                svg.append("g")
                                        .attr("transform", "translate(0," + height + ")")
                                        .call(d3.axisBottom(x))

                                // Add Y axis
                                var y = d3.scaleLinear()
                                        .domain([0, 40])
                                        .range([height, 0]);
                                svg.append("g")
                                        .attr("class", "myYaxis")
                                        .call(d3.axisLeft(y));

                                // A function that create / update the plot for a given variable:
                                function update(data, type) {

                                        var u = svg.selectAll("rect")
                                                .data(data)
                                        let color =  "#69b3a2";
                                        if (type==="female") {
                                                color = "#fdfd96";

                                        }

                                        u
                                                .enter()
                                                .append("rect")
                                                .merge(u)
                                                .transition()
                                                .duration(1000)
                                                .attr("x", function (d) { return x(d.group); })
                                                .attr("y", function (d) { return y(d.value); })
                                                .attr("width", x.bandwidth())
                                                .attr("height", function (d) { return height - y(d.value); })
                                                .attr("fill", color)

                                        svg.append("text")      // text label for the x axis
                                                .attr("x", width/2)
                                                .attr("y", height+50)
                                                .style("text-anchor", "middle")
                                                .text("Year");


                                        svg.append("text")
                                                .attr("transform", "rotate(-90)")
                                                .attr("y", -60)
                                                .attr("x", 0 - (height / 2))
                                                .attr("dy", "1em")
                                                .style("text-anchor", "middle")
                                                .text("Number of people (thousands)")
                                }
                                // Initialize the plot with the first dataset
                                update(data1)




                                //PIE CHART
                                    var widthPie = 450
                                        heightPie = 450
                                        marginPie = 40

                                        // The radius of the pieplot is half the width or half the height (smallest one). I subtract a bit of margin.
                                        var radius = Math.min(widthPie, heightPie) / 2 - marginPie

                                        // append the svg object to the div called 'my_dataviz'
                                        var svg2 = d3.select(".pie")
                                                .append("svg")
                                                .attr("width", widthPie)
                                                .attr("height", heightPie)
                                                .append("g")
                                                .attr("transform", "translate(" + widthPie / 2 + "," + heightPie / 2 + ")");

                                        // create 2 data_set
                                        var data3 = { a: 87, b: 12 }
                                        var data4 = { a: 54, b: 35 }
                                        var data5 = { a: 23, b: 12 , c:56 }

                                        // set the color scale
                                        var color = d3.scaleOrdinal()
                                                .domain(["a", "b", 'c'])
                                                .range(['#ff6961', '#779ecb', "#aa77dd"]);

                                        // A function that create / update the plot for a given variable:
                                        function updatePie(data, type) {
                                                svg2.select('text').remove()
                                                let title = "Did you request to obtain Swiss citizenship?"

                                                if (type === "intention") {
                                                        title = "Do you have an intention of requesting naturalization?"
                                                } else if (type === "status") {
                                                        title = "What is your status of application?"

                                                }

                                                // Compute the position of each group on the pie:
                                                var pie = d3.pie()
                                                        .value(function (d) { return d.value; })
                                                        .sort(function (a, b) { return d3.ascending(a.key, b.key); }) // This make sure that group order remains the same in the pie chart
                                                var data_ready = pie(d3.entries(data))

                                                // map to data
                                                var u = svg2.selectAll("path")
                                                        .data(data_ready)

                                                // Build the pie chart: Basically, each part of the pie is a path that we build using the arc function.
                                                u
                                                        .enter()
                                                        .append('path')
                                                        .merge(u)
                                                        .transition()
                                                        .duration(1000)
                                                        .attr('d', d3.arc()
                                                                .innerRadius(0)
                                                                .outerRadius(radius)
                                                        )
                                                        .attr('fill', function (d) { return (color(d.data.key)) })
                                                        .attr("stroke", "white")
                                                        .style("stroke-width", "2px")
                                                        .style("opacity", 1)

                                                svg2.append("text")      // text label for the x axis
                                                        .attr("x", 0)
                                                        .attr("y", -200)
                                                        .style("text-anchor", "middle")
                                                        .text(title);
                                                // svg2.html(title);
                                                // remove the group that is not present anymore
                                                u
                                                        .exit()
                                                        .remove()

                                        }

                                        // Initialize the plot with the first dataset
                                        updatePie(data3, "request")
                           


                                      
        </script>
</body>

</html>